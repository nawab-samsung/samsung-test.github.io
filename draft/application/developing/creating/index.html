<h1 id="creating-tizen-images-with-mic">Creating Tizen Images with MIC</h1>

<p>This topic provides information on how to create a Tizen image.</p>

<p>Before creating an image, study the following instructions:</p>

<ul>
  <li><a href="setting-up.md">Setting up the Development Environment</a></li>
  <li><a href="installing.md">Installing Development Tools</a></li>
  <li><a href="cloning.md">Cloning Tizen Source Files</a></li>
  <li><a href="building.md">Building Packages Locally with GBS</a></li>
</ul>

<h2 id="preparing-the-kickstart-file">Preparing the Kickstart File</h2>

<p>Image creation requires a kickstart file that describes how to create an image. To prepare the kickstart file:</p>

<ol>
  <li>
    <p>Download the original kickstart file:</p>

    <pre><code>$ wget &lt;Snapshot_date_URL&gt;/builddata/images/&lt;Repository&gt;/image-configurations/&lt;kickstart_file&gt;
</code></pre>

    <ul>
      <li>
        <p>For example:</p>

        <ul>
          <li>
            <p>Tizen: 4.0: Unified / standard / <code>mobile-wayland-armv7l-tm1.ks</code></p>

            <pre><code>$ wget http://download.tizen.org/releases/daily/tizen/unified/tizen-unified_20170627.1/builddata/images/standard/image-configurations/mobile-wayland-armv7l-tm1.ks
</code></pre>
          </li>
          <li>
            <p>Tizen: 4.0: Unified / emulator / <code>tv-emulator32-wayland.ks</code></p>

            <pre><code>$ wget http://download.tizen.org/releases/daily/tizen/unified/tizen-unified_20170627.1/builddata/images/emulator/image-configurations/tv-emulator32-wayland.ks
</code></pre>
          </li>
          <li>
            <p>Tizen: 3.0: Wearable / target-circle / <code>wearable-wayland-armv7l-circle.ks</code></p>

            <pre><code>$ wget http://download.tizen.org/releases/daily/tizen/3.0-wearable/tizen-3.0-wearable_20170627.1/builddata/images/target-circle/image-configurations/wearable-wayland-armv7l-circle.ks
</code></pre>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>Modify the original kickstart file to include locally built RPMs into the Tizen image.</p>

    <p>For example: Tizen: 4.0: Unified / standard / <code>mobile-wayland-armv7l-tm1.ks</code></p>

    <ul>
      <li>
        <p>The <code>repo</code> section of the original kickstart file:</p>

        <pre><code>repo --name=unified-standard --baseurl=http://download.tizen.org/snapshots/tizen/unified/@BUILD_ID@/repos/standard/packages/ --ssl_verify=no
repo --name=base_arm --baseurl=http://download.tizen.org/snapshots/tizen/base/latest/repos/arm/packages/ --ssl_verify=no
</code></pre>
      </li>
      <li>
        <p>The <code>repo</code> section of the modified kickstart file:</p>

        <pre><code>repo --name=unified-standard --baseurl=http://download.tizen.org/snapshots/tizen/unified/@BUILD_ID@/repos/standard/packages/ --ssl_verify=no --priority=99
repo --name=base_arm --baseurl=http://download.tizen.org/snapshots/tizen/base/latest/repos/arm/packages/ --ssl_verify=no --priority=99
repo --name=local --baseurl=file:///home/&lt;User&gt;/GBS-ROOT/local/repos/tizen3.0-tm1/armv7l/ --priority=1
</code></pre>
      </li>
    </ul>

    <blockquote>
      <p><strong>Note</strong></p>

      <ul>
        <li>The <code>baseurl</code> property of the <code>local</code> repo specifies the file path where locally built RPMs are located.</li>
        <li>Setting the priority of the <code>local</code> repository at 1 and the priorities of remote repositories at 99 guarantees that MIC uses the packages that exist in the local repository with a higher priority, when packages are available in both remote and local repositories.</li>
        <li>To add new packages into a Tizen image, add the new packagesâ€™ names into the <code>%package</code> section, and add them into the <code>local</code> repository.</li>
      </ul>
    </blockquote>
  </li>
</ol>

<h2 id="creating-a-tizen-image">Creating a Tizen Image</h2>

<p>To create a Tizen image:</p>

<pre><code>$ gbs createimage --ks-file=mobile-wayland-armv7l-tm1.ks
</code></pre>

<p>If you have more than 4 GB of RAM available, use the <code>--tmpfs</code> option to speed up the image creation:</p>

<pre><code>$ gbs createimage --ks-file=mobile-wayland-armv7l-tm1.ks --tmpfs
</code></pre>

<p>The following example shows the <code>gbs createimage</code> command output:</p>

<pre><code>...
Info: Running scripts ...
kickstart post script start
Info: Checking filesystem /var/tmp/mic/build/imgcreate-Rii2MC/tmp-pVQesQ/platform.img
Info: Checking filesystem /var/tmp/mic/build/imgcreate-Rii2MC/tmp-pVQesQ/data.img
Info: Checking filesystem /var/tmp/mic/build/imgcreate-Rii2MC/tmp-pVQesQ/ums.img
Info: Pack all loop images together to TM1-new-201609030819.tar.gz
Info: The new image can be found here:
/home/&lt;User&gt;/tizen/mic-output/TM1-201609030819.tar.gz
/home/&lt;User&gt;/tizen/mic-output/TM1-201609030833.packages
/home/&lt;User&gt;/tizen/mic-output/TM1-201609030819.xml
Info: Finished.
</code></pre>

<p><code>TM1-201609030819.tar.gz</code> is the image file and <code>TM1-201609030833.packages</code> contains package info integrated in the image, including package name, version, and VCS information.</p>

<p>Once the Tizen image is created, the final step is to flash the image to a target device for verification. For more information, see <a href="flashing.md">Flashing an Image to Device</a>.</p>
